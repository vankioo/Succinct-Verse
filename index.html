<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Succinct Verse</title>
    <link rel="stylesheet" type="text/css" href="assets/flaticon/flaticon.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>

  <div id="welcome-screen">
    <div class="welcome-content">
        <img src="assets/images/succinct-verse-logo.png" alt="Succinct Verse Logo" id="welcome-logo">
        <button id="enter-btn">Click to Enter</button>
    </div>
</div>
    <div id="main-app" class="hidden">
        <header class="top-menubar">
            <div class="menu-left"><span class="app-name">Succinct Verse</span></div>
            <div class="menu-right">
             <div class="menu-right">
                <div id="notification-widget">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H6.414l-3.707 2.354A.5.5 0 0 1 2 15.914V2z"/>
                    </svg>
                    <span class="notification-badge"></span>
                    <div class="notification-dropdown">
                        <div class="dropdown-header">Notifications</div>
                        <ul id="notification-list"></ul>
                    </div>
                </div>
                 <div class="cpu-widget"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="white" viewBox="0 0 24 24"><path d="M9 2v2H7V2H5v2H4a2 2 0 0 0-2 2v2h2v8H2v2a2 2 0 0 0 2 2h1v2h2v-2h2v2h2v-2h8v2h2v-2h2a2 2 0 0 0 2-2v-2h-2V8h2V6a2 2 0 0 0-2-2h-1V2h-2v2h-2V2h-2v2H9V2H7zm0 4h8v12H7V6z"/></svg><div class="cpu-bar-container"><div class="cpu-bar"></div></div></div>
                <span id="date-widget"></span><span id="clock">10:10</span>
            </div>
        </header>
        <main class="desktop">
            <a href="https://succinct-network.vercel.app/" target="_blank" class="desktop-icon"><img src="assets/images/3.png" alt="ZK Constellation"><span>ZK Constellation</span></a>
            <a href="" target="_blank" class="desktop-icon"><img src="assets/images/3.png" alt="Proof of Synergy"><span>Proof of Synergy</span></a>
            <a href="https://succinct-zk-forge.vercel.app/" target="_blank" class="desktop-icon"><img src="assets/images/2.png" alt="ZK Forge"><span>ZK Forge</span></a>
        </main>
        <footer class="dock">
            <div class="dock-container">
                <a href="javascript:void(0);" id="open-community-board" class="dock-item" title="Community Board"><img src="assets/images/icon-succinct.svg" alt="Community Board"><span>Community Board</span></a>
                <a href="javascript:void(0);" id="open-sp1-verifier" class="dock-item" title="SP1 Verifier"><img src="assets/images/Ethereum.svg" alt="SP1 Verifier"><span>SP1 Verifier</span></a>
                <div class="separator"></div>
                <a href="https://twitter.com/Duskiesoul" target="_blank" class="dock-item" title="Twitter/X"><img src="assets/images/icon-twitter.png" alt="Twitter/X"><span>Twitter/X</span></a>
                <a href="https://discord.gg/succinctlabs" target="_blank" class="dock-item" title="Discord"><img src="assets/images/icon-discord.png" alt="Discord"><span>Discord</span></a>
            </div>
        </footer>
    </div>
    <audio id="background-music" src="assets/backsound.mp3" loop></audio>
    <div id="sp1-verifier-modal" class="modal-container hidden">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <button id="close-sp1-modal" class="modal-close-btn">&times;</button>
            <h2>SP1 Verifier Demo</h2>
            <p>look at how a ZK proof is made.</p>
            <div id="sp1-educational-console" class="console"></div>
        </div>
    </div>
    <div id="community-board-modal" class="modal-container hidden">
        <div class="modal-overlay"></div>
        <div class="modal-content wide">
            <button id="close-community-modal" class="modal-close-btn">&times;</button>
            <h2>Community Memorial Wall</h2>
            <div id="gallery-view">
                <div class="gallery-header">
                    <p>All art contributed by the Succinct Community.</p>
                    <button id="add-your-art-btn" class="submit-art-btn small">Add Your Art</button>
                </div>
                <div id="art-gallery-container"><p class="loading-text">Loading memorial wall...</p></div>
            </div>
            <div id="username-view" class="hidden">
                 <p>Enter your Twitter username to leave your mark.</p>
                 <div class="input-group">
                    <span>@</span>
                    <input type="text" id="username-input" placeholder="username" maxlength="15">
                    <button id="continue-to-draw-btn">Continue</button>
                </div>
                <button id="back-to-gallery-btn-from-username" class="back-button">Back to Gallery</button>
            </div>
            <div id="drawing-view" class="hidden">
                <p>Drawing as <strong id="username-display">@username</strong>.</p>
                <div class="drawing-area">
                    <div class="tools">
                        <label for="colorPicker">Color:</label><input type="color" id="colorPicker" value="#FE11C5">
                        <label for="brushSize">Size:</label><input type="range" id="brushSize" min="1" max="50" value="5">
                        <button id="eraserBtn">Eraser</button><button id="clearBtn">Clear</button>
                    </div>
                    <canvas id="drawing-canvas"></canvas>
                </div>
                <div class="drawing-actions">
                    <button id="back-to-username-btn">Back</button>
                    <button id="submitArtBtn" class="submit-art-btn">Lock In Your Art</button>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        // ===== 1. KONEKSI FIREBASE (TIDAK BERUBAH) =====
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
        import { getFirestore, collection, addDoc, getDocs, query, where, limit, orderBy } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore.js";
        
        const firebaseConfig = {
            apiKey: "AIzaSyCFKSgYfeR_Gql7qZdP5_EYVw-BO5VkNCE",
            authDomain: "succinct-comboard.firebaseapp.com",
            projectId: "succinct-comboard",
            storageBucket: "succinct-comboard.appspot.com",
            messagingSenderId: "853910523370",
            appId: "1:853910523370:web:f0b2e11ba95067bc35f693"
        };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const artCollection = collection(db, "arts");
        
        // ===== 2. SEMUA LOGIKA DIMASUKKAN DALAM SATU EVENT LISTENER INI =====
        document.addEventListener('DOMContentLoaded', function() {
            
            // --- LOGIKA UI DASAR (TOMBOL ENTER, JAM, NOTIFIKASI) ---
         <script>
    // ===== SEMUA LOGIKA DIMASUKKAN DALAM SATU EVENT LISTENER INI =====
    document.addEventListener('DOMContentLoaded', function() {
        
        // --- INI BAGIAN YANG DIPERBAIKI: LOGIKA UNTUK WELCOME SCREEN & MUSIK ---
        const welcomeScreen = document.getElementById('welcome-screen');
        const mainApp = document.getElementById('main-app');
        const music = document.getElementById('background-music');

        if (welcomeScreen) {
            // Pemicu sekarang adalah seluruh layar, bukan tombol
            welcomeScreen.addEventListener('click', () => {
                // Logika musik dan menampilkan aplikasi utama
                if (music) {
                    music.volume = 0.3;
                    music.play().catch(e => console.error("Audio play failed:", e));
                }
                
                // Transisi fade-out yang halus
                if (welcomeScreen) {
                    welcomeScreen.style.opacity = '0';
                    setTimeout(() => {
                        welcomeScreen.style.display = 'none';
                    }, 500); // Waktu cocok dengan transisi di CSS
                }
                
                if (mainApp) mainApp.classList.remove('hidden');
                
            }, { once: true }); // Hanya bisa diklik sekali
        }

        // --- SISA KODE (NOTIFIKASI, JAM, DLL. TIDAK BERUBAH) ---
        const chatNotifications=[{name:"Yinger UwU",photo:"assets/images/yinger.png",message:"Dont forget succinct rockstars!"},{name:"Addyyeah",photo:"assets/images/addy.jpg",message:"Mainnet soon yeahh"},{name:"Zaharon bruhh",photo:"assets/images/zaharon.jpg",message:"Log in bruhh, lets play together"},{name:"Duskieee",photo:"assets/images/duskie.jpg",message:"Thanks for joining!"}];function showRandomNotifications(){const e=document.getElementById("notification-list");if(e){e.innerHTML="";const t=chatNotifications.sort(()=>.5-Math.random())[0];t&&(e.innerHTML=`<li class="notification-item"><img src="${t.photo}" alt="${t.name}"><div class="notification-content"><p>${t.name}</p><span>${t.message}</span></div></li>`)}}function updateDateTime(){const e=new Date,t=document.getElementById("clock"),o=document.getElementById("date-widget");t&&(t.textContent=e.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1})),o&&(o.textContent=e.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}))}showRandomNotifications(),updateDateTime(),setInterval(updateDateTime,1e3);

        // ... Semua kode untuk popup Community Board dan SP1 Verifier akan ada di sini ...
    });
<script type="module">
    // ===== 1. KONEKSI FIREBASE (TIDAK BERUBAH) =====
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
    import { getFirestore, collection, addDoc, getDocs, query, where, limit, orderBy } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore.js";
    
    const firebaseConfig = {
        apiKey: "AIzaSyCFKSgYfeR_Gql7qZdP5_EYVw-BO5VkNCE",
        authDomain: "succinct-comboard.firebaseapp.com",
        projectId: "succinct-comboard",
        storageBucket: "succinct-comboard.appspot.com",
        messagingSenderId: "853910523370",
        appId: "1:853910523370:web:f0b2e11ba95067bc35f693"
    };
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const artCollection = collection(db, "arts");
    
    // ===== 2. SEMUA LOGIKA DIMASUKKAN DALAM SATU EVENT LISTENER INI =====
    document.addEventListener('DOMContentLoaded', function() {
        
        // --- LOGIKA UI DASAR (TOMBOL ENTER, JAM, NOTIFIKASI) ---
        const enterBtn = document.getElementById('enter-btn');
        const welcomeScreen = document.getElementById('welcome-screen');
        const mainApp = document.getElementById('main-app');
        const music = document.getElementById('background-music');

        if (enterBtn) {
            enterBtn.addEventListener('click', () => {
                if (music) {
                    music.volume = 0.3;
                    music.play().catch(e => console.error("Audio play failed:", e));
                }
                if (welcomeScreen) {
                    welcomeScreen.style.opacity = '0';
                    setTimeout(() => {
                        welcomeScreen.style.display = 'none';
                    }, 500); 
                }
                if (mainApp) mainApp.classList.remove('hidden');
            }, { once: true });
        }
        
        const chatNotifications=[{name:"Yinger UwU",photo:"assets/images/yinger.png",message:"Dont forget succinct rockstars!"},{name:"Addyyeah",photo:"assets/images/addy.jpg",message:"Mainnet soon yeahh"},{name:"Zaharon bruhh",photo:"assets/images/zaharon.jpg",message:"Log in bruhh, lets play together"},{name:"Duskieee",photo:"assets/images/duskie.jpg",message:"Thanks for joining!"}];
        function showRandomNotifications(){
            const list = document.getElementById("notification-list");
            const badge = document.querySelector(".notification-badge");
            if (!list || !badge) return;
            list.innerHTML = "";
            const selected = chatNotifications.sort(() => .5 - Math.random())[0];
            if (selected) {
                list.innerHTML = `<li class="notification-item"><img src="${selected.photo}" alt="${selected.name}"><div class="notification-content"><p>${selected.name}</p><span>${selected.message}</span></div></li>`;
                badge.style.display = 'block';
            }
        }

        function updateDateTime(){
            const now = new Date, clock = document.getElementById("clock"), date = document.getElementById("date-widget");
            if(clock) clock.textContent = now.toLocaleTimeString("en-US", { hour: "2-digit", minute: "2-digit", hour12: !1 });
            if(date) date.textContent = now.toLocaleDateString("en-US", { weekday: "short", month: "short", day: "numeric" });
        }

        showRandomNotifications();
        updateDateTime();
        setInterval(updateDateTime, 1000);

        // --- PENGONTROL POPUP UMUM ---
        function setupModal(buttonId, modalId, closeButtonId, onOpen) {
            const openBtn = document.getElementById(buttonId);
            const modal = document.getElementById(modalId);
            const closeBtn = document.getElementById(closeButtonId);
            if (!openBtn || !modal || !closeBtn) return;
            const open = () => { modal.classList.remove('hidden'); modal.classList.add('visible'); if (onOpen) onOpen(); };
            const close = () => { modal.classList.remove('visible'); setTimeout(() => modal.classList.add('hidden'), 300); };
            openBtn.addEventListener('click', open);
            closeBtn.addEventListener('click', close);
            modal.querySelector('.modal-overlay').addEventListener('click', close);
        }

        // --- LOGIKA SP1 VERIFIER ---
        const eduConsole = document.getElementById("sp1-educational-console");
        async function runEducationalAnimation() {
            if (!eduConsole) return;
            eduConsole.innerHTML = '';
            const delay = ms => new Promise(res => setTimeout(res, ms));

            const steps = [
                { title: 'Initializing ZKVM...', desc: 'Preparing the Zero-Knowledge Virtual Machine to run our program.', visual: () => { const d = document.createElement('div'); d.className = 'step-diagram'; d.innerHTML = `<div class="diagram-box">ZKVM Ready</div>`; return d; }},
                { title: 'Compiling program...', desc: 'Translating Rust code into verifiable instructions.', visual: () => { const d = document.createElement('div'); d.className = 'step-diagram'; d.innerHTML = `<div class="diagram-box">Rust Code</div><div class="diagram-arrow">→</div><div class="diagram-box">Bytecode</div>`; return d; }},
                { title: 'Generating proof...', desc: 'Creating a compact cryptographic proof from the full execution trace.', visual: () => { const d = document.createElement('div'); d.className = 'step-diagram'; d.innerHTML = `<div class="diagram-box" id="trace-box" style="padding: 30px 15px;">Execution Trace</div><div class="diagram-arrow">→</div><div class="diagram-box small" id="proof-box">ZK Proof</div>`; return d; }},
                { title: '✅ Execution Verified.', desc: 'The proof is valid! The program ran correctly.', visual: () => { const d = document.createElement('div'); d.className = 'step-diagram'; d.innerHTML = `<div class="diagram-box small">Final Proof</div>`; return d; }}
            ];
            
            for (const step of steps) {
                await delay(1200);
                const stepDiv = document.createElement('div');
                stepDiv.className = 'step';
                const stepTitle = document.createElement('div');
                stepTitle.className = 'step-title';
                stepTitle.textContent = `> ${step.title}`;
                const stepDesc = document.createElement('div');
                stepDesc.className = 'step-desc';
                stepDesc.textContent = step.desc;
                stepDiv.appendChild(stepTitle);
                if (step.visual) { stepDiv.appendChild(step.visual()); }
                stepDiv.appendChild(stepDesc);
                eduConsole.appendChild(stepDiv);
                requestAnimationFrame(() => { stepDiv.classList.add('visible'); });
                eduConsole.scrollTop = eduConsole.scrollHeight;
            }
            
            await delay(1000);
            const analogy = document.createElement('div');
            analogy.className = 'final-analogy step';
            analogy.innerHTML = "<strong>Analogy:</strong> Instead of showing your entire math homework (the execution trace), you just show a special 'magic checkmark' (the ZK proof) that proves you did it correctly without revealing any of the steps.";
            eduConsole.appendChild(analogy);
            requestAnimationFrame(() => { analogy.classList.add('visible'); });
            eduConsole.scrollTop = eduConsole.scrollHeight;
        }
        setupModal("open-sp1-verifier", "sp1-verifier-modal", "close-sp1-modal", runEducationalAnimation);

        // --- LOGIKA COMMUNITY BOARD ---
        const galleryView = document.getElementById("gallery-view");
        const usernameView = document.getElementById("username-view");
        const drawingView = document.getElementById("drawing-view");
        const addArtBtn = document.getElementById("add-your-art-btn");
        const backToGalleryBtn1 = document.getElementById("back-to-gallery-btn-from-username");
        const backToUsernameBtn = document.getElementById("back-to-username-btn");
        const galleryContainer = document.getElementById("art-gallery-container");
        const usernameInput = document.getElementById("username-input");
        const continueBtn = document.getElementById("continue-to-draw-btn");
        const usernameDisplay = document.getElementById("username-display");
        const canvas = document.getElementById("drawing-canvas");
        let currentUsername = "";

        function showView(viewToShow) {
            [galleryView, usernameView, drawingView].forEach(v => v.classList.add('hidden'));
            viewToShow.classList.remove('hidden');
        }

        addArtBtn.addEventListener('click', () => showView(usernameView));
        backToGalleryBtn1.addEventListener('click', () => showView(galleryView));
        backToUsernameBtn.addEventListener('click', () => showView(usernameView));
        
        continueBtn.addEventListener('click', async () => {
            const username = usernameInput.value.trim();
            if (!username) {
                alert('Please enter a username.');
                return;
            }
            const q = query(artCollection, where("username", "==", username.toLowerCase()), limit(1));
            const querySnapshot = await getDocs(q);
            if (!querySnapshot.empty) {
                alert(`Username @${username} has already submitted art. Please choose another.`);
            } else {
                currentUsername = username;
                usernameDisplay.textContent = `@${currentUsername}`;
                setupCanvas();
                showView(drawingView);
            }
        });

        async function loadAllArt() {
            galleryContainer.innerHTML = '<p class="loading-text">Loading memorial wall...</p>';
            try {
                const q = query(artCollection, orderBy("createdAt", "desc"));
                const querySnapshot = await getDocs(q);
                galleryContainer.innerHTML = "";
                if (querySnapshot.empty) {
                    galleryContainer.innerHTML = '<p class="loading-text">The wall is empty. Be the first to leave a mark!</p>';
                } else {
                    querySnapshot.forEach(doc => {
                        const art = doc.data();
                        const artPiece = document.createElement('div');
                        artPiece.className = 'art-piece';
                        const img = new Image();
                        img.src = art.imageData;
                        const userLabel = document.createElement('span');
                        userLabel.className = 'art-username';
                        userLabel.textContent = `@${art.username}`;
                        artPiece.appendChild(img);
                        artPiece.appendChild(userLabel);
                        galleryContainer.appendChild(artPiece);
                    });
                }
            } catch (error) {
                console.error("Failed to load art:", error);
                galleryContainer.innerHTML = '<p class="loading-text">Could not load the memorial wall. Please try again later.</p>';
            }
        }

        setupModal("open-community-board", "community-board-modal", "close-community-modal", () => {
            showView(galleryView);
            loadAllArt();
        });

        if (canvas) {
            const ctx = canvas.getContext('2d');
            const colorPicker = document.getElementById("colorPicker");
            const brushSize = document.getElementById("brushSize");
            const eraserBtn = document.getElementById("eraserBtn");
            const clearBtn = document.getElementById("clearBtn");
            const submitArtBtn = document.getElementById("submitArtBtn");
            let isDrawing = false, isEraser = false;

            function setupCanvas() {
                const area = canvas.parentElement;
                canvas.width = area.clientWidth;
                canvas.height = 400;
                ctx.fillStyle = "white";
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.lineJoin = 'round';
                ctx.lineCap = 'round';
                submitArtBtn.disabled = false;
                submitArtBtn.textContent = 'Lock In Your Art';
                canvas.style.pointerEvents = 'auto';
            }

            function startDrawing(e) { isDrawing = true; draw(e); }
            function stopDrawing() { isDrawing = false; ctx.beginPath(); }
            function draw(e) {
                if (!isDrawing) return;
                e.preventDefault();
                const rect = canvas.getBoundingClientRect();
                const x = (e.clientX || e.touches[0].clientX) - rect.left;
                const y = (e.clientY || e.touches[0].clientY) - rect.top;
                ctx.lineWidth = brushSize.value;
                ctx.strokeStyle = isEraser ? "white" : colorPicker.value;
                ctx.lineTo(x, y);
                ctx.stroke();
                ctx.beginPath();
                ctx.moveTo(x, y);
            }

            canvas.addEventListener('pointerdown', startDrawing);
            canvas.addEventListener('pointerup', stopDrawing);
            canvas.addEventListener('pointerout', stopDrawing);
            canvas.addEventListener('pointermove', draw);
            clearBtn.addEventListener('click', () => { ctx.fillStyle = "white"; ctx.fillRect(0, 0, canvas.width, canvas.height); });
            eraserBtn.addEventListener('click', () => { isEraser = !isEraser; eraserBtn.classList.toggle('active', isEraser); });
            
            submitArtBtn.addEventListener('click', async () => {
                if (!currentUsername) {
                    alert("An error occurred. Please go back and re-enter your username.");
                    return;
                }
                try {
                    const imageData = canvas.toDataURL('image/png');
                    submitArtBtn.disabled = true;
                    submitArtBtn.textContent = "Saving...";
                    await addDoc(artCollection, {
                        username: currentUsername.toLowerCase(),
                        imageData: imageData,
                        createdAt: new Date()
                    });
                    alert("Your art has been saved to the memorial wall!");
                    showView(galleryView);
                    loadAllArt();
                } catch (error) {
                    console.error("Error saving art:", error);
                    alert("Sorry, could not save your art.");
                    submitArtBtn.disabled = false;
                    submitArtBtn.textContent = "Lock In Your Art";
                }
            });
        }
    });
</script>
</body>
</html>
