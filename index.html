<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Succinct Verse</title>
    <link rel="stylesheet" type="text/css" href="assets/flaticon/flaticon.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="welcome-screen">
        <div class="welcome-content">
            <img src="assets/images/succinct-verse-logo.png" alt="Succinct Verse Logo" id="welcome-logo">
            <p class="enter-prompt">Click anywhere to enter</p>
        </div>
    </div>
    
    <div id="main-app" class="hidden">
        <header class="top-menubar">
            <div class="menu-left"><span class="app-name">Succinct Verse</span></div>
            <div class="menu-right">
                <div id="notification-widget">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M8 16a2 2 0 0 0 2-2H6a2 2 0 0 0 2 2zM8 1.918l-.797.161A4.002 4.002 0 0 0 4 6c0 .628-.134 2.197-.459 3.742-.16.767-.376 1.566-.663 2.258h10.244c-.287-.692-.502-1.49-.663-2.258C12.134 8.197 12 6.628 12 6a4.002 4.002 0 0 0-3.203-3.92L8 1.918zM14.22 12c.223.447.481.801.78 1H1c.299-.199.557-.553.78-1C2.68 10.2 3 6.88 3 6c0-2.42 1.72-4.44 4.005-4.901a1 1 0 1 1 1.99 0A5.002 5.002 0 0 1 13 6c0 .88.32 3.2 1.22 6z"/></svg>
                    <span class="notification-badge"></span>
                    <div class="notification-dropdown">
                        <div class="dropdown-header">Notifications</div>
                        <ul id="notification-list"></ul>
                    </div>
                </div>
                <div class="cpu-widget"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M5 0a.5.5 0 0 1 .5.5V2h1V.5a.5.5 0 0 1 1 0V2h1V.5a.5.5 0 0 1 1 0V2h1V.5a.5.5 0 0 1 1 0V2A2.5 2.5 0 0 1 14 4.5h1.5a.5.5 0 0 1 0 1H14v1h1.5a.5.5 0 0 1 0 1H14v1h1.5a.5.5 0 0 1 0 1H14v1h1.5a.5.5 0 0 1 0 1H14A2.5 2.5 0 0 1 11.5 14v1.5a.5.5 0 0 1-1 0V14h-1v1.5a.5.5 0 0 1-1 0V14h-1v1.5a.5.5 0 0 1-1 0V14h-1v1.5a.5.5 0 0 1-1 0V14A2.5 2.5 0 0 1 2 11.5H.5a.5.5 0 0 1 0-1H2v-1H.5a.5.5 0 0 1 0-1H2v-1H.5a.5.5 0 0 1 0-1H2v-1H.5a.5.5 0 0 1 0-1H2A2.5 2.5 0 0 1 4.5 2V.5A.5.5 0 0 1 5 0zm-.5 3h6a.5.5 0 0 0 .5-.5V2h-7v.5a.5.5 0 0 0 .5.5zm7 8h-7a.5.5 0 0 0-.5.5V12h7v-.5a.5.5 0 0 0-.5-.5z"/></svg><div class="cpu-bar-container"><div class="cpu-bar"></div></div></div>
                <span id="date-widget"></span><span id="clock">10:10</span>
            </div>
        </header>
        <main class="desktop">
            <a href="https://succinct-network.vercel.app/" target="_blank" class="desktop-icon"><img src="assets/images/icon1.png" alt="ZK Constellation"><span>ZK Constellation</span></a>
            <a href="#" class="desktop-icon disabled" title="Coming Soon!"><img src="assets/images/icon3.png" alt="Proof of Synergy"><span>Proof of Synergy</span></a>
            <a href="https://succinct-zk-forge.vercel.app/" target="_blank" class="desktop-icon"><img src="assets/images/icon2.png" alt="ZK Forge"><span>ZK Forge</span></a>
        </main>
        <footer class="dock">
            <div class="dock-container">
                <a href="javascript:void(0);" id="open-community-board" class="dock-item" title="Community Board"><img src="assets/images/icon-board.png" alt="Community Board"><span>Community Board</span></a>
                <a href="javascript:void(0);" id="open-sp1-verifier" class="dock-item" title="SP1 Verifier"><img src="assets/images/icon-verifier.png" alt="SP1 Verifier"><span>SP1 Verifier</span></a>
                <div class="separator"></div>
                <a href="https://twitter.com/Duskiesoul" target="_blank" class="dock-item" title="Twitter/X"><img src="assets/images/icon-twitter.png" alt="Twitter/X"><span>Twitter/X</span></a>
                <a href="https://discord.gg/succinctlabs" target="_blank" class="dock-item" title="Discord"><img src="assets/images/icon-discord.png" alt="Discord"><span>Discord</span></a>
            </div>
        </footer>
    </div>
    <audio id="background-music" src="assets/backsound.mp3" loop></audio>

    <div id="sp1-verifier-modal" class="modal-container hidden">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <button id="close-sp1-modal" class="modal-close-btn">&times;</button>
            <h2>SP1 Verifier Demo</h2>
            <p>An educational look at how a ZK proof is made.</p>
            <div id="sp1-educational-console" class="console"></div>
        </div>
    </div>
    
    <div id="community-board-modal" class="modal-container hidden">
        <div class="modal-overlay"></div>
        <div class="modal-content wide">
            <button id="close-community-modal" class="modal-close-btn">&times;</button>
            <h2>Community Memorial Wall</h2>
            <div id="gallery-view">
                <div class="gallery-header">
                    <p>All art contributed by the Succinct Community.</p>
                    <button id="add-your-art-btn" class="submit-art-btn small">Add Your Art</button>
                </div>
                <div id="art-gallery-container"><p class="loading-text">Loading memorial wall...</p></div>
            </div>
            <div id="username-view" class="hidden">
                 <p>Enter your Twitter username to leave your mark.</p>
                 <div class="input-group">
                    <span>@</span>
                    <input type="text" id="username-input" placeholder="username" maxlength="15">
                    <button id="continue-to-draw-btn">Continue</button>
                </div>
                <button id="back-to-gallery-btn-from-username" class="back-button">Back to Gallery</button>
            </div>
            <div id="drawing-view" class="hidden">
                <p>Drawing as <strong id="username-display">@username</strong>.</p>
                <div class="drawing-area">
                    <div class="tools">
                        <label for="colorPicker">Color:</label><input type="color" id="colorPicker" value="#FE11C5">
                        <label for="brushSize">Size:</label><input type="range" id="brushSize" min="1" max="50" value="5">
                        <button id="eraserBtn">Eraser</button><button id="clearBtn">Clear</button>
                    </div>
                    <canvas id="drawing-canvas"></canvas>
                </div>
                <div class="drawing-actions">
                    <button id="back-to-username-btn">Back</button>
                    <button id="submitArtBtn" class="submit-art-btn">Lock In Your Art</button>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        // ===== 1. KONEKSI FIREBASE (TIDAK BERUBAH) =====
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
        import { getFirestore, collection, addDoc, getDocs, query, where, limit, orderBy } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore.js";
        
        const firebaseConfig = {
            apiKey: "AIzaSyCFKSgYfeR_Gql7qZdP5_EYVw-BO5VkNCE",
            authDomain: "succinct-comboard.firebaseapp.com",
            projectId: "succinct-comboard",
            storageBucket: "succinct-comboard.appspot.com",
            messagingSenderId: "853910523370",
            appId: "1:853910523370:web:f0b2e11ba95067bc35f693"
        };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const artCollection = collection(db, "arts");
        
        // ===== 2. SEMUA LOGIKA DIMASUKKAN DALAM SATU EVENT LISTENER INI =====
        document.addEventListener('DOMContentLoaded', function() {
            // --- LOGIKA UI DASAR ---
            const welcomeScreen = document.getElementById('welcome-screen');
            const mainApp = document.getElementById('main-app');
            const music = document.getElementById('background-music');
            if (welcomeScreen) {
                welcomeScreen.addEventListener('click', () => {
                    if (music) { music.volume = 0.3; music.play().catch(e => console.error("Audio play failed:", e)); }
                    if (welcomeScreen) { welcomeScreen.style.opacity = 0; setTimeout(() => welcomeScreen.style.display = 'none', 500); }
                    if (mainApp) mainApp.classList.remove('hidden');
                }, { once: true });
            }
            
            const chatNotifications = [{ name: "Yinger UwU", photo: "assets/images/yinger.png", message: "Dont forget succinct rockstars!"}, { name: "Addyyeah", photo: "assets/images/addy.jpg", message: "Mainnet soon yeahh"}, { name: "Zaharon bruhh", photo: "assets/images/zaharon.jpg", message: "Log in bruhh, lets play together"}, { name: "Duskieee", photo: "assets/images/duskie.jpg", message: "Thanks for joining!"}];
            function showRandomNotifications() {
                const list = document.getElementById("notification-list");
                const badge = document.querySelector(".notification-badge");
                if (!list || !badge) return;
                list.innerHTML = "";
                const shuffled = chatNotifications.sort(() => .5 - Math.random());
                const selected = shuffled[0];
                if (selected) {
                    list.innerHTML = `<li class="notification-item"><img src="${selected.photo}" alt="${selected.name}"><div class="notification-content"><p>${selected.name}</p><span>${selected.message}</span></div></li>`;
                    badge.style.display = 'block';
                }
            }
            function updateDateTime() { const now = new Date, clock = document.getElementById("clock"), date = document.getElementById("date-widget"); clock && (clock.textContent = now.toLocaleTimeString("en-US", { hour: "2-digit", minute: "2-digit", hour12: !1 })), date && (date.textContent = now.toLocaleDateString("en-US", { weekday: "short", month: "short", day: "numeric" })) }
            showRandomNotifications(); updateDateTime(); setInterval(updateDateTime, 1e3);

            // --- PENGONTROL POPUP UMUM ---
            function setupModal(t,o,n,a){const d=document.getElementById(t),i=document.getElementById(o),c=document.getElementById(n);if(d&&i&&c){const t=()=>{i.classList.remove("hidden"),i.classList.add("visible"),a&&a()},o=()=>{i.classList.remove("visible"),setTimeout(()=>i.classList.add("hidden"),300)};d.addEventListener("click",t),c.addEventListener("click",o),i.querySelector(".modal-overlay").addEventListener("click",o)}}

            // --- LOGIKA SP1 VERIFIER (VERSI EDUKATIF DETAIL) ---
            const eduConsole = document.getElementById("sp1-educational-console");
            async function runEducationalAnimation() {
                if (!eduConsole) return;
                eduConsole.innerHTML = '';
                const delay = ms => new Promise(res => setTimeout(res, ms));

                const steps = [
                    { title: 'Initializing ZKVM...', desc: 'Preparing the Zero-Knowledge Virtual Machine to run our program.', visual: () => { const d = document.createElement('div'); d.className = 'step-diagram'; d.innerHTML = `<div class="diagram-box">ZKVM Ready</div>`; return d; }},
                    { title: 'Compiling program...', desc: 'Translating Rust code into verifiable instructions.', visual: () => { const d = document.createElement('div'); d.className = 'step-diagram'; d.innerHTML = `<div class="diagram-box">Rust Code</div><div class="diagram-arrow">→</div><div class="diagram-box">Bytecode</div>`; return d; }},
                    { title: 'Generating proof...', desc: 'Creating a compact cryptographic proof from the full execution trace.', visual: () => { const d = document.createElement('div'); d.className = 'step-diagram'; d.innerHTML = `<div class="diagram-box" id="trace-box" style="padding: 30px 15px;">Execution Trace</div><div class="diagram-arrow">→</div><div class="diagram-box small" id="proof-box">ZK Proof</div>`; return d; }},
                    { title: '✅ Execution Verified.', desc: 'The proof is valid! The program ran correctly.', visual: () => { const d = document.createElement('div'); d.className = 'step-diagram'; d.innerHTML = `<div class="diagram-box small">Final Proof</div>`; return d; }}
                ];
                
                for (const step of steps) {
                    await delay(1200);
                    const stepDiv = document.createElement('div');
                    stepDiv.className = 'step';
                    const stepTitle = document.createElement('div');
                    stepTitle.className = 'step-title';
                    stepTitle.textContent = `> ${step.title}`;
                    const stepDesc = document.createElement('div');
                    stepDesc.className = 'step-desc';
                    stepDesc.textContent = step.desc;
                    stepDiv.appendChild(stepTitle);
                    if (step.visual) { stepDiv.appendChild(step.visual()); }
                    stepDiv.appendChild(stepDesc);
                    eduConsole.appendChild(stepDiv);
                    requestAnimationFrame(() => { stepDiv.classList.add('visible'); });
                    eduConsole.scrollTop = eduConsole.scrollHeight;
                }
                
                await delay(1000);
                const analogy = document.createElement('div');
                analogy.className = 'final-analogy step';
                analogy.innerHTML = "<strong>Analogy:</strong> Instead of showing your entire math homework (the execution trace), you just show a special 'magic checkmark' (the ZK proof) that proves you did it correctly without revealing any of the steps.";
                eduConsole.appendChild(analogy);
                requestAnimationFrame(() => { analogy.classList.add('visible'); });
                eduConsole.scrollTop = eduConsole.scrollHeight;
            }
            setupModal("open-sp1-verifier", "sp1-verifier-modal", "close-sp1-modal", runEducationalAnimation);

            // --- LOGIKA COMMUNITY BOARD ---
            const galleryView=document.getElementById("gallery-view"),usernameView=document.getElementById("username-view"),drawingView=document.getElementById("drawing-view"),addArtBtn=document.getElementById("add-your-art-btn"),backToGalleryBtn1=document.getElementById("back-to-gallery-btn-from-username"),backToUsernameBtn=document.getElementById("back-to-username-btn"),galleryContainer=document.getElementById("art-gallery-container"),usernameInput=document.getElementById("username-input"),continueBtn=document.getElementById("continue-to-draw-btn"),usernameDisplay=document.getElementById("username-display"),canvas=document.getElementById("drawing-canvas");let currentUsername="";function showView(e){[galleryView,usernameView,drawingView].forEach(t=>t.classList.add("hidden")),e.classList.remove("hidden")}addArtBtn.addEventListener("click",()=>showView(usernameView)),backToGalleryBtn1.addEventListener("click",()=>showView(galleryView)),backToUsernameBtn.addEventListener("click",()=>showView(usernameView)),continueBtn.addEventListener("click",async()=>{const e=usernameInput.value.trim();if(e){const t=query(artCollection,where("username","==",e.toLowerCase()),limit(1));(await getDocs(t)).empty?(currentUsername=e,usernameDisplay.textContent=`@${currentUsername}`,setupCanvas(),showView(drawingView)):alert(`Username @${e} has already submitted art. Please choose another.`)}else alert("Please enter a username.")});async function loadAllArt(){galleryContainer.innerHTML='<p class="loading-text">Loading memorial wall...</p>';try{const e=await getDocs(query(artCollection,orderBy("createdAt","desc")));if(galleryContainer.innerHTML="",e.empty)galleryContainer.innerHTML='<p class="loading-text">The wall is empty. Be the first to leave a mark!</p>';else{e.forEach(e=>{const t=e.data(),o=document.createElement("div");o.className="art-piece";const n=new Image;n.src=t.imageData;const a=document.createElement("span");a.className="art-username",a.textContent=`@${t.username}`,o.appendChild(n),o.appendChild(a),galleryContainer.appendChild(o)})}}catch(e){console.error("Failed to load art:",e),galleryContainer.innerHTML='<p class="loading-text">Could not load the memorial wall. Please try again later.'}}setupModal("open-community-board","community-board-modal","close-community-modal",()=>{showView(galleryView),loadAllArt()});if(canvas){const ctx=canvas.getContext("2d"),colorPicker=document.getElementById("colorPicker"),brushSize=document.getElementById("brushSize"),eraserBtn=document.getElementById("eraserBtn"),clearBtn=document.getElementById("clearBtn"),submitArtBtn=document.getElementById("submitArtBtn");let isDrawing=!1,isEraser=!1;function setupCanvas(){const e=canvas.parentElement;canvas.width=e.clientWidth,canvas.height=400,ctx.fillStyle="white",ctx.fillRect(0,0,canvas.width,canvas.height),ctx.lineJoin="round",ctx.lineCap="round",submitArtBtn.disabled=!1,submitArtBtn.textContent="Lock In Your Art",canvas.style.pointerEvents="auto"}function startDrawing(e){isDrawing=!0,draw(e)}function stopDrawing(){isDrawing=!1,ctx.beginPath()}function draw(e){if(isDrawing){e.preventDefault();const t=canvas.getBoundingClientRect(),o=(e.clientX||e.touches[0].clientX)-t.left,n=(e.clientY||e.touches[0].clientY)-t.top;ctx.lineWidth=brushSize.value,ctx.strokeStyle=isEraser?"white":colorPicker.value,ctx.lineTo(o,n),ctx.stroke(),ctx.beginPath(),ctx.moveTo(o,n)}}canvas.addEventListener("pointerdown",startDrawing),canvas.addEventListener("pointerup",stopDrawing),canvas.addEventListener("pointerout",stopDrawing),canvas.addEventListener("pointermove",draw),clearBtn.addEventListener("click",()=>{ctx.fillStyle="white",ctx.fillRect(0,0,canvas.width,canvas.height)}),eraserBtn.addEventListener("click",()=>{isEraser=!isEraser,eraserBtn.classList.toggle("active",isEraser)}),submitArtBtn.addEventListener("click",async()=>{if(currentUsername)try{const e=canvas.toDataURL("image/png");submitArtBtn.disabled=!0,submitArtBtn.textContent="Saving...",await addDoc(artCollection,{username:currentUsername.toLowerCase(),imageData:e,createdAt:new Date}),alert("Your art has been saved to the memorial wall!"),showView(galleryView),loadAllArt()}catch(e){console.error("Error saving art:",e),alert("Sorry, could not save your art."),submitArtBtn.disabled=!1,submitArtBtn.textContent="Lock In Your Art"}else alert("An error occurred. Please go back and re-enter your username.")})}
        });
    </script>
</body>
</html>
